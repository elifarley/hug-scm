#!/usr/bin/env bash
CMD_BASE="$(readlink -f "$0" 2>/dev/null || greadlink -f "$0")" || CMD_BASE="$0"; CMD_BASE="$(dirname "$CMD_BASE")"
for f in hug-common hug-git-kit; do . "$CMD_BASE/../lib/$f"; done
set -euo pipefail  # Exit on error, undefined vars, pipe failures

# Part of the Hug tool suite

show_help() {
  printf 'hug llf: Log commits to a file (handles renames).\n' >&2
  printf -- '-<N>: Limit to last N commits (e.g., -1 for most recent).\n' >&2
  printf -- '-p: Show patches.\n' >&2
  printf 'Usage: hug llf <file> [-N] [-p] [log options]\n' >&2
  printf 'Examples:\n' >&2
  printf '  hug llf file.txt -1          # Most recent commit touching file\n' >&2
  printf '  hug llf file.txt -2 --stat  # Last 2 commits with stats\n' >&2
}

if [ $# -eq 0 ] || [ "$1" = '-h' ] || [ "$1" = '--help' ]; then
  show_help
  exit 1
fi

file="$1"; shift

exec hug ll "$@" --follow -- "$file"

