#!/usr/bin/env bash
CMD_BASE="$(readlink -f "$0" 2>/dev/null || greadlink -f "$0")" || CMD_BASE="$0"; CMD_BASE="$(dirname "$CMD_BASE")"
for f in hug-common hug-git-kit hug-select-files output_json_status; do . "$CMD_BASE/../lib/$f"; done
set -euo pipefail

# Part of the Hug tool suite

# Show only ignored files, then summary

# Early exit if not in Git repo
check_git_repo

# Parse arguments for JSON output
json_output=false
for arg in "$@"; do
  case "$arg" in
    --json)
      json_output=true
      ;;
  esac
done

# Build list_files_with_status options for ignored files only
list_opts=("--ignored")

# JSON output mode
if $json_output; then
  output_json_status "${list_opts[@]}"
else
  # Show ignored files
  if ! list_files_with_status "${list_opts[@]}" 2>/dev/null; then
    info "No ignored files."
  fi

  # Show summary line
  exec hug s
fi