#!/usr/bin/env sh
# Part of the Hug tool suite

show_help() {
    cat << EOF
h undo: Take back commits and unstages their changes: HEAD goes back, their changes are kept unstaged.

USAGE:
    hug h undo [N|COMMIT]

DESCRIPTION:
    Deletes the specified commits and moves the HEAD back.
    Changes introduced by the removed commits are kept (staged).
    Working directory isn't affected at all.

EXAMPLES:
    hug h undo        # delete last commit, keep changes unstaged
    hug h undo 3      # delete last 3 commits, keep changes unstaged
    hug h undo a1b2c3 # delete commits AFTER specified commit, keep changes unstaged

SEE ALSO:
    hug h back          Take back commits and keep their changes staged.
EOF
}

case "${1:-}" in
  '-h'|'--help')
    show_help
    exit 1;;
  '') target='HEAD~1' ;;
  [1-9]|[1-9][0-9]|[1-9][0-9][0-9]) target="HEAD~$1" ;;
  *) target="$1" ;;
esac
git reset --mixed "$target"
